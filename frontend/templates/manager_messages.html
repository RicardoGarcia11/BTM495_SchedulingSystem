<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manager Dashboard - Messages</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/managermessages.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    
  </style>
</head>
<body>
  <nav>
    <ul>
      <li><a href="{{ url_for('manager_dashboard') }}">SCHEDULE</a></li>
      <li><a href="{{ url_for('manager_createschedule') }}">CREATE SCHEDULE</a></li>
      <li><a href="{{ url_for('manager_requests') }}" >REQUESTS</a></li>
      <li><a href="{{ url_for('manager_messages') }}" class="active">MESSAGES</a></li>
      <li><a href="{{ url_for('manager_reports') }}">REPORTS</a></li>
    </ul>
    <div class="dropdown">
      <div class="dropdown-toggle">Manager</div>
      <div class="dropdown-menu">
        <a href="/logout">LOG OUT</a>
      </div>
    </div>
  </nav>

  <div class="main-container">
    <div class="sidebar">
      <div class="search-box">
        <input type="text" placeholder="Search">
      </div>
      <div class="section">
        <h3>Chats</h3>
        <div class="chat-list">
          <div class="chat-item" onclick="selectChat(this)">Employee 1</div>
          <div class="chat-item" onclick="selectChat(this)">Employee 2</div>
          <div class="chat-item" onclick="selectChat(this)">Employee 3</div>
        </div>
      </div>
      <div class="section">
        <h3>Contacts</h3>
        <div class="contact-list">
          <div class="contact-item" onclick="selectChat(this)">Employee 4</div>
          <div class="contact-item" onclick="selectChat(this)">Employee 5</div>
          <div class="contact-item" onclick="selectChat(this)">Employee 6</div>
          <div class="contact-item" onclick="selectChat(this)">Employee 7</div>
        </div>
      </div>
    </div>

    <div class="chat-window">
      <div class="chat-header">
        <div class="info">
          <strong id="chat-title">Employee 1</strong>
          <small>Online - Last seen 2:02pm</small>
        </div>
      </div>
      <div class="chat-body" id="chat-body">
        <div class="message sent">Hi! Are you joining the meeting today?</div>
        <div class="message received">Yes, I’ll be there in 5 minutes.</div>
        <div class="message sent">Perfect, see you then!</div>
      </div>
      <div class="chat-input">
        <input type="text" id="message-input" placeholder="Type your message here...">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <script>
    const chatMessages = {
      "Employee 1": [
        ["Hi ! Are you joining the meeting today?", "received"],
        ["Yes, I’ll be there in 5 minutes.", "received"],
        ["Perfect, see you then!", "sent"]
      ],
      "Employee 2": [
        ["Hey, great job on the presentation!", "sent"],
        ["Thanks a lot! Couldn't have done it without the team.", "received"]
      ],
      "Employee 3": [
        ["Hey , did you upload the report?", "sent"],
        ["Yes, it’s in the shared folder.", "received"]
      ]
    };
  
    let currentChat = null;
  
    function selectChat(element) {
      document.querySelectorAll('.chat-item, .contact-item').forEach(item =>
        item.classList.remove('active')
      );
      element.classList.add('active');
  
      currentChat = element.innerText;
      document.getElementById("chat-title").innerText = currentChat;
  
      const chatBody = document.getElementById("chat-body");
      chatBody.innerHTML = "";
  
      const messages = chatMessages[currentChat] || [];
      messages.forEach(([text, type]) => {
        const msgDiv = document.createElement("div");
        msgDiv.className = `message ${type}`;
        msgDiv.textContent = text;
        chatBody.appendChild(msgDiv);
      });
  
      chatBody.scrollTop = chatBody.scrollHeight;
    }
  
    function sendMessage() {
      const input = document.getElementById("message-input");
      const text = input.value.trim();
      if (text && currentChat) {
        const chatBody = document.getElementById("chat-body");
        const message = document.createElement("div");
        message.className = "message sent";
        message.textContent = text;
        chatBody.appendChild(message);
        input.value = "";
        chatBody.scrollTop = chatBody.scrollHeight;
  
        // Save to chat history
        if (!chatMessages[currentChat]) {
          chatMessages[currentChat] = [];
        }
        chatMessages[currentChat].push([text, "sent"]);
  
        // If it came from contacts, move to chats
        const existingChat = Array.from(document.querySelectorAll(".chat-item"))
          .find(item => item.innerText === currentChat);
        if (!existingChat) {
          const contact = Array.from(document.querySelectorAll(".contact-item"))
            .find(item => item.innerText === currentChat);
          if (contact) {
            const newChat = contact.cloneNode(true);
            newChat.className = "chat-item active";
            newChat.onclick = () => selectChat(newChat);
            document.querySelector(".chat-list").appendChild(newChat);
            contact.remove();
  
            // Remove active from others
            document.querySelectorAll('.chat-item').forEach(item =>
              item.classList.remove('active')
            );
            newChat.classList.add('active');
          }
        }
      }
    }
  </script>
  
</body>
</html>
